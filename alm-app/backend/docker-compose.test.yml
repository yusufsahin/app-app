# Postgres for backend integration tests. Port 5433 to avoid conflict with main app (5432).
#   docker compose -f backend/docker-compose.test.yml up -d
#   ALM_TEST_DATABASE_URL=postgresql+asyncpg://alm:alm_dev_password@localhost:5433/alm_test uv run pytest
services:
  postgres:
    image: postgres:16-alpine
    environment:
      POSTGRES_USER: alm
      POSTGRES_PASSWORD: alm_dev_password
      POSTGRES_DB: alm_test
    ports:
      - "5433:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U alm -d alm_test"]
      interval: 2s
      timeout: 3s
      retries: 5
